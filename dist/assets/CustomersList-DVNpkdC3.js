import{r,j as e}from"./index-DavSq415.js";import{a as c}from"./axios-B2YOV0tR.js";import{S as n}from"./sweetalert2.esm.all-BGf-Fe8G.js";import{H as v}from"./Helmet-CWmtKA_n.js";import{S as B}from"./Sidebar-ByFRoWwf.js";const $=()=>{const[p,x]=r.useState([]),[N,u]=r.useState(!0),[E,h]=r.useState(null),[I,b]=r.useState(null),[m,f]=r.useState(!1),y=localStorage.getItem("role"),g=()=>{f(!m)},d="https://api.nafismu.xyz/api/customers";r.useEffect(()=>{const t=new AbortController,s=t.signal;return(async()=>{try{const o=await c.get(d,{signal:s});x(o.data),u(!1)}catch{h("Failed to fetch customers"),u(!1)}})(),()=>t.abort()},[]);const w=async()=>{const{value:t}=await n.fire({title:"Input Customer Data",html:`
                <button id="close-btn" class="swal2-close" style="background-color:transparent; border:none; cursor:pointer; font-size:24px; position:absolute; top:10px; right:10px;">&times;</button>
                <input id="name" class="swal2-input" placeholder="Name" required>
                <input id="email" class="swal2-input" placeholder="Email" required>
                <input id="phone" class="swal2-input" placeholder="Phone" required>
                <input id="subscription" class="swal2-input" placeholder="Subscription" required>
                <input id="sign_date" class="swal2-input" type="datetime-local" required>
            `,showCancelButton:!0,confirmButtonText:"Submit",cancelButtonText:"Back",focusConfirm:!1,background:"#f0f8ff",confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",customClass:{popup:"custom-swal-popup"},didOpen:()=>{document.getElementById("close-btn").addEventListener("click",()=>{n.close()})},preConfirm:()=>{const s=document.getElementById("name").value,a=document.getElementById("email").value,o=document.getElementById("phone").value,l=document.getElementById("subscription").value,i=document.getElementById("sign_date").value;return!s||!a||!l||!i?(n.showValidationMessage("All fields are required"),null):{name:s,email:a,phone:o,subscription:l,signup_date:i}}});if(t)try{const s={name:t.name,email:t.email,phone:t.phone,subscription:t.subscription,signup_date:t.signup_date};await c.post(d,s),n.fire({title:"Success!",text:"Customer added successfully!",icon:"success",confirmButtonText:"OK"}),fetchCustomers()}catch(s){n.fire({title:"Error!",text:`There was an error adding the customer! ${s.message}`,icon:"error",confirmButtonText:"OK"})}},j=t=>{b(t.id),n.fire({title:"Edit Customer Data",html:`
                <button id="close-btn" class="swal2-close" style="background-color:transparent; border:none; cursor:pointer; font-size:24px; position:absolute; justify-item:center; top:10px; right:10px;">&times;</button>
                <input id="name" class="swal2-input" value="${t.name}" required>
                <input id="email" class="swal2-input" value="${t.email}" required>
                <input id="phone" class="swal2-input" value="${t.phone}" required>
                <input id="subscription" class="swal2-input" value="${t.subscription}" required>
                <input id="signup_date" class="swal2-input" type="datetime-local" value="${t.signup_date}" required>
            `,didOpen:()=>{document.getElementById("close-btn").addEventListener("click",()=>{n.close()})},focusConfirm:!1,preConfirm:()=>{const s=document.getElementById("name").value,a=document.getElementById("email").value,o=document.getElementById("phone").value,l=document.getElementById("subscription").value,i=document.getElementById("signup_date").value;return!s||!a||!l||!o||!i?(n.showValidationMessage("All fields are required"),null):{name:s,email:a,subscription:l,phone:o,signup_date:i}}}).then(async s=>{if(s.isConfirmed){const a={name:s.value.name,email:s.value.email,subscription:s.value.subscription,phone:s.value.phone,signup_date:s.value.signup_date};try{await c.put(`${d}/${t.id}`,a),n.fire("Success!","Customer updated successfully!","success"),fetchCustomers()}catch{n.fire("Error!","Failed to update customer","error")}}})},C=async t=>{if((await n.fire({title:"Are you sure?",text:"You won't be able to revert this!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, delete it!",cancelButtonText:"Cancel"})).isConfirmed)try{await c.delete(`${d}/${t}`),fetchCustomers(),n.fire({title:"Deleted!",text:"Customer has been deleted.",icon:"success",confirmButtonText:"OK"})}catch{n.fire({title:"Error!",text:"Failed to delete customer.",icon:"error",confirmButtonText:"OK"})}};return e.jsxs("div",{className:"flex min-h-screen bg-gradient-to-b from-blue-50 to-white",children:[e.jsx(B,{role:y,isOpen:m,toggleSidebar:g}),e.jsx(v,{children:e.jsx("title",{children:"Customer List Page"})}),e.jsxs("div",{className:"container my-12 mx-auto py-8 px-4",children:[e.jsx("div",{className:"flex flex-col md:flex-row md:justify-between mb-4 space-y-2 md:space-y-0",children:e.jsx("button",{className:"bg-green-500 text-white font-bold py-2 px-4 rounded-md w-full md:w-auto",onClick:w,children:"Tambah Pelanggan"})}),e.jsxs("div",{className:"text-center mb-10",children:[e.jsx("h1",{className:"text-3xl md:text-5xl font-bold text-blue-700 mb-4",children:"List Daftar Pelanggan"}),e.jsx("div",{className:"w-16 md:w-24 h-1 bg-blue-500 mx-auto rounded-full"})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full bg-white border text-sm md:text-base",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-200 text-left",children:[e.jsx("th",{className:"py-2 md:py-3 px-2 md:px-6 border-b",children:"No"}),e.jsx("th",{className:"py-2 md:py-3 px-2 md:px-6 border-b",children:"Nama"}),e.jsx("th",{className:"py-2 md:py-3 px-2 md:px-6 border-b",children:"Email"}),e.jsx("th",{className:"py-2 md:py-3 px-2 md:px-6 border-b",children:"Nomor Telepon"}),e.jsx("th",{className:"py-2 md:py-3 px-2 md:px-6 border-b",children:"Berlangganan"}),e.jsx("th",{className:"py-2 md:py-3 px-2 md:px-6 border-b",children:"Tanggal Registrasi"}),e.jsx("th",{className:"py-2 md:py-3 px-2 md:px-6 border-b",children:"Aksi"})]})}),e.jsx("tbody",{children:p.map((t,s)=>e.jsxs("tr",{className:"border-b hover:bg-gray-100",children:[e.jsx("td",{className:"py-2 md:py-3 px-2 md:px-6",children:s+1}),e.jsx("td",{className:"py-2 md:py-3 px-2 md:px-6",children:t.name}),e.jsx("td",{className:"py-2 md:py-3 px-2 md:px-6",children:t.email}),e.jsx("td",{className:"py-2 md:py-3 px-2 md:px-6",children:t.phone}),e.jsx("td",{className:"py-2 md:py-3 px-2 md:px-6",children:t.subscription}),e.jsx("td",{className:"py-2 md:py-3 px-2 md:px-6",children:t.signup_date}),e.jsxs("td",{className:"py-3 px-6 flex justify-center mt-3",children:[e.jsx("button",{className:"bg-yellow-500 text-white px-4 py-2 mr-2 rounded hover:bg-yellow-600",onClick:()=>j(t),children:"Edit"}),e.jsx("button",{className:"bg-red-500 text-white px-4 py-2 rounded hover:bg-red-600",onClick:()=>C(t.id),children:"Delete"})]})]},t.id))})]})})]})]})};export{$ as default};
