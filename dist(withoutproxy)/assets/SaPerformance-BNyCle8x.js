import{r,j as e}from"./index-DavSq415.js";import{a as I}from"./axios-B2YOV0tR.js";import{H as z}from"./Helmet-CWmtKA_n.js";import{S as H}from"./Sidebar-ByFRoWwf.js";import"./sweetalert2.esm.all-BGf-Fe8G.js";const $=()=>{const[g,j]=r.useState([]),[m,i]=r.useState([]),[f,N]=r.useState(""),[c,y]=r.useState(""),[d,v]=r.useState(""),[a,w]=r.useState(null),[S,x]=r.useState(!1),[b,F]=r.useState(!1),D=()=>{F(!b)};r.useEffect(()=>{const t=new AbortController,s=t.signal;return(async()=>{try{const n=await(await fetch("https://api.nafismu.xyz/api/sales-performance",{signal:s})).json();j(n),i(n)}catch(l){l.name==="AbortError"?console.log("Fetch aborted"):console.error("Error fetching user:",l)}})(),()=>{t.abort()}},[]);const[h,k]=r.useState(null),C=t=>{k(t.target.files[0])},E=async t=>{if(t.preventDefault(),!h){alert("Silakan pilih file untuk diunggah");return}const s=new FormData;s.append("file",h);try{const o=await I.post("https://api.nafismu.xyz/api/upload",s,{headers:{"Content-Type":"multipart/form-data"}});alert("File berhasil diunggah: "+o.data.message),x(!1)}catch(o){console.error("Error uploading file:",o),alert("Gagal mengunggah file")}},P=t=>{const s=t.target.value;N(s),u(s,c,d)},A=t=>{const s=t.target.value;y(s),u(f,s,d)},O=t=>{const s=t.target.value;v(s),u(f,c,s)},u=(t,s,o)=>{let l=g;t&&(l=l.filter(n=>n[t]>0)),s&&(l=l.filter(n=>new Date(n.tanggal)>=new Date(s))),o&&(l=l.filter(n=>new Date(n.tanggal)<=new Date(o))),i(l)},p=t=>{let s="ascending";a&&a.key===t&&a.direction==="ascending"&&(s="descending");const o=[...m].sort((l,n)=>l[t]<n[t]?s==="ascending"?-1:1:l[t]>n[t]?s==="ascending"?1:-1:0);w({key:t,direction:s}),i(o)};return e.jsxs("div",{className:"flex min-h-screen bg-gradient-to-b from-blue-50 to-white",children:[e.jsx(z,{children:e.jsx("title",{children:"Sales Performance Page"})}),e.jsx(H,{role:"admin",isOpen:b,toggleSidebar:D}),e.jsxs("div",{className:"container mx-auto px-4 py-8 justify-between",children:[e.jsx("div",{className:"ml-auto text-right sticky",children:e.jsx("button",{onClick:()=>x(!0),className:"text-white hover:bg-red-500 text-center text-3xl bg-gray-500 p-6 rounded-full",style:{position:"fixed",right:"20px",bottom:"20px",zIndex:1e3},children:"+"})}),S&&e.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-8 shadow-lg w-96",children:[e.jsx("h2",{className:"text-2xl font-semibold mb-4 text-blue-700",children:"Unggah File"}),e.jsxs("form",{onSubmit:E,className:"flex flex-col gap-4",children:[e.jsx("input",{type:"file",onChange:C,className:"border border-blue-200 rounded-lg p-2.5 focus:outline-none focus:ring-2 focus:ring-blue-400"}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx("button",{type:"submit",className:"bg-blue-500 text-white px-4 py-2 rounded-lg hover:bg-blue-600 transition-colors",disabled:!h,children:"Unggah"}),e.jsx("button",{onClick:()=>x(!1),type:"button",className:"bg-gray-200 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-300 transition-colors",children:"Batal"})]})]})]})}),e.jsxs("div",{className:"text-center mb-10",children:[e.jsx("h1",{className:"text-5xl font-bold text-blue-700 mb-4",children:"SA Performance"}),e.jsx("div",{className:"w-24 h-1 bg-blue-500 mx-auto rounded-full"})]}),e.jsx("div",{className:"mb-8",children:e.jsxs("div",{className:"flex gap-4 flex-wrap",children:[e.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6 hover:shadow-xl transition-shadow flex-1 min-w-[250px]",children:[e.jsx("label",{className:"text-blue-700 font-medium mb-2 block",children:"Filter by Funnel"}),e.jsxs("select",{onChange:P,className:"w-full border border-blue-200 rounded-lg p-2.5 focus:ring-2 focus:ring-blue-400 focus:border-blue-400 hover:border-blue-300 transition-colors",children:[e.jsx("option",{value:"",children:"All Funnels"}),e.jsx("option",{value:"f0",children:"F0 (Lead)"}),e.jsx("option",{value:"f1",children:"F1 (Opportunity)"}),e.jsx("option",{value:"f2",children:"F2 (Proposal)"}),e.jsx("option",{value:"f3",children:"F3 (Bidding)"}),e.jsx("option",{value:"f4",children:"F4 (Negotiation)"}),e.jsx("option",{value:"f5",children:"F5 (Contract)"})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6 hover:shadow-xl transition-shadow flex-1 min-w-[250px]",children:[e.jsx("label",{className:"text-blue-700 font-medium mb-2 block",children:"Start Date"}),e.jsx("input",{type:"date",onChange:A,value:c,className:"w-full border border-blue-200 rounded-lg p-2.5 focus:ring-2 focus:ring-blue-400 focus:border-blue-400 hover:border-blue-300 transition-colors"})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6 hover:shadow-xl transition-shadow flex-1 min-w-[250px]",children:[e.jsx("label",{className:"text-blue-700 font-medium mb-2 block",children:"End Date"}),e.jsx("input",{type:"date",onChange:O,value:d,className:"w-full border border-blue-200 rounded-lg p-2.5 focus:ring-2 focus:ring-blue-400 focus:border-blue-400 hover:border-blue-300 transition-colors"})]})]})}),e.jsx("div",{className:"bg-white rounded-xl shadow-lg overflow-hidden mt-16",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-blue-600 text-white",children:[e.jsx("th",{className:"py-4 px-6 text-left font-semibold",children:"No"}),e.jsxs("th",{className:"py-4 px-6 text-left font-semibold cursor-pointer hover:bg-blue-700 transition-colors",onClick:()=>p("kode"),children:["Kode ",(a==null?void 0:a.key)==="kode"&&(a.direction==="ascending"?"↑":"↓")]}),e.jsx("th",{className:"py-4 px-6 text-left font-semibold",children:"Mitra"}),e.jsx("th",{className:"py-4 px-6 text-left font-semibold",children:"Nama SA"}),e.jsxs("th",{className:"py-4 px-6 text-left font-semibold cursor-pointer hover:bg-blue-700 transition-colors",onClick:()=>p("spm"),children:["SPH ",(a==null?void 0:a.key)==="spm"&&(a.direction==="ascending"?"↑":"↓")]}),["F0","F1","F2","F3","F4","F5"].map((t,s)=>e.jsxs("th",{className:"py-4 px-6 text-left font-semibold cursor-pointer hover:bg-blue-700 transition-colors",onClick:()=>p(`f${s}`),children:[t," ",(a==null?void 0:a.key)===`f${s}`&&(a.direction==="ascending"?"↑":"↓")]},t)),e.jsx("th",{className:"py-4 px-6 text-left font-semibold",children:"Tanggal"})]})}),e.jsx("tbody",{children:m.map((t,s)=>e.jsxs("tr",{className:"border-b border-blue-100 hover:bg-blue-50 transition-colors",children:[e.jsx("td",{className:"py-3 px-6",children:s+1}),e.jsx("td",{className:"py-3 px-6 font-medium text-blue-600",children:t.kode}),e.jsx("td",{className:"py-3 px-6",children:t.mitra}),e.jsx("td",{className:"py-3 px-6",children:t.namaSA}),e.jsx("td",{className:"py-3 px-6",children:t.sph}),e.jsx("td",{className:"py-3 px-6",children:t.f0}),e.jsx("td",{className:"py-3 px-6",children:t.f1}),e.jsx("td",{className:"py-3 px-6",children:t.f2}),e.jsx("td",{className:"py-3 px-6",children:t.f3}),e.jsx("td",{className:"py-3 px-6",children:t.f4}),e.jsx("td",{className:"py-3 px-6",children:t.f5}),e.jsx("td",{className:"py-3 px-6",children:new Date(t.tanggal).toLocaleDateString("Ind",{day:"numeric",month:"long",year:"numeric"})})]},s))})]})})})]})]})};export{$ as default};
